<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="15th Anniversary">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC&display=swap&subset=chinese-traditional"
  rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Xanh+Mono&display=swap" rel="stylesheet">
<script src="https://unpkg.com/vue@3"></script>
<script src="https://unpkg.com/luxon@2"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.3.2/dist/echarts.min.js"
  integrity="sha256-7rldQObjnoCubPizkatB4UZ0sCQzu2ePgyGSUcVN70E=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-echarts@6.0.3/dist/index.umd.min.js"
  integrity="sha256-S5lDhdkRVLPhwfjxDpUpf89Zu3o3fpe3XxBlE8qF1uo=" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DGKBYYKDBT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DGKBYYKDBT');
</script>
<style>
  #app {
    font-family: 'Noto Sans TC', sans-serif;
  }
  time {
    font-family: 'Xanh Mono', monospace;
    font-size: 100px;
  }
  #chart-container {
    position: relative;
    height: 50vh;
    overflow: hidden;
  }
</style>
<title>15th Anniversary</title>
</head>
<body>
<div id="app">
  <p>距離 15 週年剩下 {{ untilAnniversary.full }}。</p>
  <time>{{ untilAnniversary.short }}</time>
  <p>{{ untilAnniversary.days }}-{{ untilAnniversary.hours }}-{{ untilAnniversary.minutes }}-{{ untilAnniversary.seconds }}</p>
  <p>{{ option }}</p>
  <v-chart id="chart-container" autoresize :option="option" />
</div>
<script>
  var DateTime = luxon.DateTime,
    Duration = luxon.Duration;
  const Taipei = { zone: 'Asia/Taipei' },
    employeedDate = DateTime.fromSQL('2007-12-06', Taipei);

  Vue.createApp({
    data() {
      return {
        now: DateTime.now().set({ milliseconds: 0 }),
        anniversaryDate: employeedDate.plus({ year: 15 }),
      };
    },
    computed: {
      countDiff() {
        return this.anniversaryDate.diff(this.now, [
          'days', 'hours', 'minutes', 'seconds',
        ]).toObject();
      },
      untilAnniversary() {
        var currentDuration = Duration.fromObject(this.countDiff),
          currentDurationObj = currentDuration.toObject(),
          days = currentDurationObj.days,
          hours = currentDurationObj.hours,
          minutes = currentDurationObj.minutes,
          seconds = currentDurationObj.seconds,
          formats = {
            full: currentDuration.toFormat('d 天 h 小時 m 分 s 秒'),
            short: currentDuration.toFormat('ddd:hh:mm:ss'),
            days: days,
            hours: hours,
            minutes: minutes,
            seconds: seconds,
          };

        return formats;
      },
      option() {
        var option = {
          series: [
            {
              type: 'gauge',
              startAngle: 90,
              endAngle: -270,
              data: [
                this.untilAnniversary.days,
              ],
              min: (
                Math.floor(this.untilAnniversary.days / 60) * 60
              ),
              max: (
                Math.ceil(this.untilAnniversary.days / 60) * 60
              ),
              splitNumber: 12,
              axisLabel: {
                formatter: (value) => {
                  if (value === 240) {
                    return '';
                  }
                  return value;
                },
              },
              detail: {
                fontFamily: 'Xanh Mono',
                formatter: (value) => {
                  // return value + 'D';
                }
              },
            },
            {
              type: 'gauge',
              startAngle: 90,
              endAngle: -270,
              data: [
                this.untilAnniversary.hours,
              ],
              max: 24,
              splitNumber: 12,
              axisLabel: {
                show: false,
              },
              itemStyle: {
                color: '#91cc75',
              },
              detail: {
                show: false,
              },
            },
            {
              type: 'gauge',
              startAngle: 90,
              endAngle: -270,
              data: [
                this.untilAnniversary.minutes,
              ],
              max: 60,
              splitNumber: 12,
              axisLabel: {
                show: false,
              },
              itemStyle: {
                color: '#fac858',
              },
              detail: {
                show: false,
              },
            },
            {
              type: 'gauge',
              startAngle: 90,
              endAngle: -270,
              data: [
                this.untilAnniversary.seconds,
              ],
              max: 60,
              splitNumber: 12,
              axisLabel: {
                show: false,
              },
              itemStyle: {
                color: '#ee6666',
              },
              detail: {
                show: false,
              },
            },
          ],
        };

        return option;
      },
    },
    mounted() {
      setInterval(() => {
        this.now = DateTime.now().set({ milliseconds: 0 })
      }, 1000);
    },
  })
  .component('v-chart', VueECharts)
  .mount('#app');
</script>
<ul id="link">
  <li><a href="./index.html">index</a></li>
  <li><a href="./15thAnniversary.html">15th Anniversary</a></li>
  <li><a href="./work.html">work</a></li>
</ul>
</body>
</html>
