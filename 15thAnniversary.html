<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="15th Anniversary">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC&display=swap&subset=chinese-traditional"
  rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Xanh+Mono&display=swap" rel="stylesheet">
<script src="https://unpkg.com/vue@3"></script>
<script src="https://unpkg.com/luxon@2"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.3.2/dist/echarts.min.js"
  integrity="sha256-7rldQObjnoCubPizkatB4UZ0sCQzu2ePgyGSUcVN70E=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-echarts@6.0.3/dist/index.umd.min.js"
  integrity="sha256-S5lDhdkRVLPhwfjxDpUpf89Zu3o3fpe3XxBlE8qF1uo=" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DGKBYYKDBT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DGKBYYKDBT');
</script>
<style>
  #app {
    font-family: 'Noto Sans TC', sans-serif;
  }
  time {
    font-family: 'Xanh Mono', monospace;
    font-size: 100px;
  }
  #chart-container {
    position: relative;
    height: 50vh;
    overflow: hidden;
  }
</style>
<title>15th Anniversary</title>
</head>
<body>
<div id="app">
  <p>距離 15 週年剩下 {{ untilAnniversary.full }}。</p>
  <time>{{ untilAnniversary.short }}</time>
  <v-chart id="chart-container" autoresize :option="option" />
</div>
<script>
  var DateTime = luxon.DateTime,
    Duration = luxon.Duration;
  const Taipei = { zone: 'Asia/Taipei' },
    employeedDate = DateTime.fromSQL('2007-12-06', Taipei);

  Vue.createApp({
    data() {
      return {
        now: DateTime.now().set({ milliseconds: 0 }),
        anniversaryDate: employeedDate.plus({ year: 15 }),
      };
    },
    computed: {
      countDiff() {
        return this.anniversaryDate.diff(this.now, [
          'days', 'hours', 'minutes', 'seconds',
        ]).toObject();
      },
      untilAnniversary() {
        var currentDuration = Duration.fromObject(this.countDiff),
          currentDurationObj = currentDuration.toObject(),
          days = currentDurationObj.days,
          hours = currentDurationObj.hours,
          minutes = currentDurationObj.minutes,
          seconds = currentDurationObj.seconds,
          formats = {
            full: currentDuration.toFormat('d 天 h 小時 m 分 s 秒'),
            short: currentDuration.toFormat('ddd:hh:mm:ss'),
            days: days,
            hours: hours,
            minutes: minutes,
            seconds: seconds,
          };

        return formats;
      },
      option() {
        var days = this.untilAnniversary.days,
          hours = this.untilAnniversary.hours,
          minutes = this.untilAnniversary.minutes,
          seconds = this.untilAnniversary.seconds,
          minDays = (days % 60 > 0) ? (Math.floor(days / 60) * 60) : days,
          maxDays = (days % 60 > 0) ? (Math.ceil(days / 60) * 60) : days + 60,
          minHours = hours >= 12 ? 12 : 0,
          maxHours = hours >= 12 ? 24 : 12,
          option = {
          series: [
            {
              name: 'days',
              type: 'gauge',
              radius: '60%',
              startAngle: 90,
              endAngle: -270,
              data: [
                days,
              ],
              min: minDays,
              max: maxDays,
              splitNumber: 6,
              // 軸線
              axisLine: {
                lineStyle: {
                  color: [
                    [1, 'red'],
                  ],
                  width: 3,
                },
              },
              // 大格
              splitLine: {
                distance: 0,
                lineStyle: {
                  color: 'red',
                },
              },
              // 小格
              axisTick: {
                splitNumber: 10,
                distance: 0,
                lineStyle: {
                  color: 'red',
                },
              },
              axisLabel: {
                distance: 10,
                formatter: (value) => {
                  if (value === maxDays) {
                    return '';
                  }
                  return value + 'ᴅ';
                },
                color: 'red',
                fontFamily: 'Arial',
              },
              pointer: {
                length: '88%',
                itemStyle: {
                  color: 'red',
                },
                width: 7,
              },
              detail: {
                show: false,
              },
              animation: false,
            },
            {
              name: 'hours',
              type: 'gauge',
              radius: '100%',
              startAngle: 90,
              endAngle: -270,
              data: [
                hours + minutes / 60,
              ],
              min: minHours,
              max: maxHours,
              splitNumber: 12,
              // 軸線
              axisLine: {
                show: false,
              },
              // 大格
              splitLine: {
                show: false,
              },
              // 小格
              axisTick: {
                show: false,
              },
              axisLabel: {
                distance: 0,
                formatter: (value) => {
                  if (value === minHours) {
                    return '';
                  }
                  return value;
                },
                fontFamily: 'Arial',
              },
              pointer: {
                icon: 'roundRect',
                length: '70%',
                width: 5,
              },
              itemStyle: {
                color: '#000',
              },
              detail: {
                show: false,
              },
              animation: false,
            },
            {
              name: 'minutes',
              type: 'gauge',
              radius: '100%',
              startAngle: 90,
              endAngle: -270,
              data: [
                minutes + seconds / 60,
              ],
              max: 60,
              splitNumber: 12,
              // 軸線
              axisLine: {
                show: false,
              },
              // 大格
              splitLine: {
                show: false,
              },
              // 小格
              axisTick: {
                show: false,
              },
              axisLabel: {
                show: false,
              },
              pointer: {
                icon: 'roundRect',
                length: '80%',
                width: 3,
              },
              itemStyle: {
                color: '#000',
              },
              detail: {
                show: false,
              },
              animation: false,
            },
            {
              name: 'seconds',
              type: 'gauge',
              radius: '100%',
              startAngle: 90,
              endAngle: -270,
              data: [
                seconds,
              ],
              max: 60,
              splitNumber: 12,
              // 軸線
              axisLine: {
                lineStyle: {
                  color: [
                    [1, '#000'],
                  ],
                  width: 3,
                },
              },
              // 大格
              splitLine: {
                distance: 0,
                lineStyle: {
                  color: '#000',
                },
              },
              // 小格
              axisTick: {
                distance: 0,
                lineStyle: {
                  color: '#000',
                },
              },
              axisLabel: {
                show: false,
              },
              pointer: {
                icon: 'roundRect',
                length: '93%',
                width: 1,
              },
              itemStyle: {
                color: '#000',
              },
              detail: {
                show: false,
              },
              animation: false,
            },
          ],
        };

        return option;
      },
    },
    mounted() {
      setInterval(() => {
        this.now = DateTime.now().set({ milliseconds: 0 })
      }, 1000);
    },
  })
  .component('v-chart', VueECharts)
  .mount('#app');
</script>
<ul id="link">
  <li><a href="./index.html">index</a></li>
  <li><a href="./15thAnniversary.html">15th Anniversary</a></li>
  <li><a href="./work.html">work</a></li>
</ul>
</body>
</html>
